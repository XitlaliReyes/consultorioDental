import{a as F,b as N,c as B,f as L,h as j,i as z,m as G,n as R,q as U}from"./chunk-V6D4ZGTB.js";import{a as Q}from"./chunk-FPKY227V.js";import{Ca as D,Da as A,Ga as W,I as r,Ia as I,O as S,Qa as k,S as f,Sa as H,X as s,Y as i,Z as n,_ as E,ca as b,da as C,fa as c,ga as h,h as O,ha as a,ia as x,ja as M,ka as P,la as m,ma as p,na as v,qa as T,sa as V,v as y,x as u,y as _}from"./chunk-WYBMJEXJ.js";function Y(g,l){g&1&&(i(0,"div",10),E(1,"div",11),i(2,"p"),a(3,"Cargando historia cl\xEDnica..."),n()())}function J(g,l){if(g&1&&(i(0,"div",12)(1,"div",13),a(2,"\u26A0\uFE0F"),n(),i(3,"h3"),a(4),n()()),g&2){let t=c();r(4),x(t.error)}}function K(g,l){if(g&1&&(i(0,"div",24)(1,"h2",25),a(2,"DATOS DEL PACIENTE"),n(),i(3,"div",26)(4,"div",27)(5,"div",28)(6,"label"),a(7,"Nombre:"),n(),i(8,"span"),a(9),n()()(),i(10,"div",27)(11,"div",29)(12,"label"),a(13,"Sexo:"),n(),i(14,"span",30)(15,"span",31),a(16,"M"),n(),i(17,"span",31),a(18,"F"),n()()(),i(19,"div",29)(20,"label"),a(21,"Edad:"),n(),i(22,"span"),a(23),n()(),i(24,"div",29)(25,"label"),a(26,"Fecha de nacimiento:"),n(),i(27,"span"),a(28),n()()(),i(29,"div",27)(30,"div",29)(31,"label"),a(32,"Direcci\xF3n:"),n(),i(33,"span"),a(34),n()(),i(35,"div",32)(36,"label"),a(37,"CP:"),n(),i(38,"span"),a(39),n()(),i(40,"div",29)(41,"label"),a(42,"Ciudad:"),n(),i(43,"span"),a(44),n()()(),i(45,"div",27)(46,"div",29)(47,"label"),a(48,"Ocupaci\xF3n:"),n(),i(49,"span"),a(50),n()(),i(51,"div",29)(52,"label"),a(53,"Tel\xE9fono:"),n(),i(54,"span"),a(55),n()()()()()),g&2){let t=c(2);r(9),x(t.paciente.Nombre),r(6),h("checked",t.paciente.Sexo==="M"),r(2),h("checked",t.paciente.Sexo==="F"),r(6),M("",t.calcularEdad(t.paciente.FechaNacimiento)," a\xF1os"),r(5),x(t.paciente.FechaNacimiento),r(6),x(t.paciente.Direccion),r(5),x(t.paciente.Codigo_Postal),r(5),x(t.paciente.Ciudad),r(6),x(t.paciente.Ocupacion||"No especificada"),r(5),x(t.paciente.Telefono)}}function X(g,l){if(g&1){let t=b();i(0,"div",55)(1,"div",56)(2,"input",57),v("ngModelChange",function(e){let o=u(t).$implicit,w=c(4);return p(w.antecedentesSeleccionados[o.ID_Tipo],e)||(w.antecedentesSeleccionados[o.ID_Tipo]=e),_(e)}),n(),i(3,"label",58),a(4),n()(),E(5,"span",59),n()}if(g&2){let t=l.$implicit,d=c(4);r(2),s("id","ant_"+t.ID_Tipo),m("ngModel",d.antecedentesSeleccionados[t.ID_Tipo]),r(),s("for","ant_"+t.ID_Tipo),r(),x(t.Nombre)}}function Z(g,l){if(g&1&&(i(0,"div",52)(1,"div",53),f(2,X,6,4,"div",54),n()()),g&2){let t=c(3);r(2),s("ngForOf",t.tiposAntecedente)}}function $(g,l){g&1&&(i(0,"div",60)(1,"p"),a(2,"No se encontraron tipos de antecedentes para cargar el checklist."),n()())}function ee(g,l){if(g&1){let t=b();i(0,"div",38)(1,"p",39),a(2,"\xBFEst\xE1 embarazada?"),n(),i(3,"div",40)(4,"label")(5,"input",61),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.otrasPreguntas.embarazada,e)||(o.otrasPreguntas.embarazada=e),_(e)}),n(),a(6," (SI) "),n(),i(7,"label")(8,"input",61),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.otrasPreguntas.embarazada,e)||(o.otrasPreguntas.embarazada=e),_(e)}),n(),a(9," (NO) "),n()()()}if(g&2){let t=c(3);r(5),s("value",!0),m("ngModel",t.otrasPreguntas.embarazada),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.embarazada)}}function te(g,l){if(g&1){let t=b();i(0,"div",33)(1,"h2",25),a(2,"ANTECEDENTES PERSONALES"),n(),f(3,Z,3,1,"div",34)(4,$,3,0,"div",35),E(5,"hr",36),i(6,"div",37)(7,"div",38)(8,"p",39),a(9,"\xBFAlergia a alguna sustancia o medicamento?"),n(),i(10,"div",40)(11,"label")(12,"input",41),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.alergiaSustancia,e)||(o.otrasPreguntas.alergiaSustancia=e),_(e)}),n(),a(13," (SI) "),n(),i(14,"label")(15,"input",41),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.alergiaSustancia,e)||(o.otrasPreguntas.alergiaSustancia=e),_(e)}),n(),a(16," (NO) "),n()()(),i(17,"div",38)(18,"p",39),a(19,"\xBFAlergia a la anestesia dental?"),n(),i(20,"div",40)(21,"label")(22,"input",42),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.alergiaAnestesia,e)||(o.otrasPreguntas.alergiaAnestesia=e),_(e)}),n(),a(23," (SI) "),n(),i(24,"label")(25,"input",42),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.alergiaAnestesia,e)||(o.otrasPreguntas.alergiaAnestesia=e),_(e)}),n(),a(26," (NO) "),n()()(),i(27,"div",38)(28,"p",39),a(29,"\xBFActualmente est\xE1 bajo alg\xFAn tratamiento?"),n(),i(30,"div",40)(31,"label")(32,"input",43),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.bajoTratamiento,e)||(o.otrasPreguntas.bajoTratamiento=e),_(e)}),n(),a(33," (SI) "),n(),i(34,"label")(35,"input",43),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.bajoTratamiento,e)||(o.otrasPreguntas.bajoTratamiento=e),_(e)}),n(),a(36," (NO) "),n()()(),i(37,"div",38)(38,"p",39),a(39,"\xBFHa sido intervenido quir\xFArgicamente?"),n(),i(40,"div",40)(41,"label")(42,"input",44),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.intervenidoQx,e)||(o.otrasPreguntas.intervenidoQx=e),_(e)}),n(),a(43," (SI) "),n(),i(44,"label")(45,"input",44),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.intervenidoQx,e)||(o.otrasPreguntas.intervenidoQx=e),_(e)}),n(),a(46," (NO) "),n()()(),i(47,"div",38)(48,"p",39),a(49,"\xBFPadece alguna enfermedad grave no mencionada?"),n(),i(50,"div",40)(51,"label")(52,"input",45),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.enfGraveNoMencionada,e)||(o.otrasPreguntas.enfGraveNoMencionada=e),_(e)}),n(),a(53," (SI) "),n(),i(54,"label")(55,"input",45),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.enfGraveNoMencionada,e)||(o.otrasPreguntas.enfGraveNoMencionada=e),_(e)}),n(),a(56," (NO) "),n()()(),f(57,ee,10,4,"div",46),i(58,"div",38)(59,"p",39),a(60,"\xBFConsume bebidas alcoh\xF3lica?"),n(),i(61,"div",40)(62,"label")(63,"input",47),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.consumeAlcohol,e)||(o.otrasPreguntas.consumeAlcohol=e),_(e)}),n(),a(64," (SI) "),n(),i(65,"label")(66,"input",47),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.consumeAlcohol,e)||(o.otrasPreguntas.consumeAlcohol=e),_(e)}),n(),a(67," (NO) "),n()()(),i(68,"div",38)(69,"p",39),a(70,"\xBFFuma?"),n(),i(71,"div",40)(72,"label")(73,"input",48),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.fuma,e)||(o.otrasPreguntas.fuma=e),_(e)}),n(),a(74," (SI) "),n(),i(75,"label")(76,"input",48),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.fuma,e)||(o.otrasPreguntas.fuma=e),_(e)}),n(),a(77," (NO) "),n()()(),i(78,"div",38)(79,"p",39),a(80,"\xBFConsume alg\xFAn tipo de droga?"),n(),i(81,"div",40)(82,"label")(83,"input",49),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.consumeDrogas,e)||(o.otrasPreguntas.consumeDrogas=e),_(e)}),n(),a(84," (SI) "),n(),i(85,"label")(86,"input",49),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.otrasPreguntas.consumeDrogas,e)||(o.otrasPreguntas.consumeDrogas=e),_(e)}),n(),a(87," (NO) "),n()()()(),i(88,"div",50)(89,"button",51),C("click",function(){u(t);let e=c(2);return _(e.guardarAntecedentesPersonales())}),a(90),n()()()}if(g&2){let t=c(2);r(3),s("ngIf",t.tiposAntecedente.length>0),r(),s("ngIf",t.tiposAntecedente.length===0&&!t.cargando),r(8),s("value",!0),m("ngModel",t.otrasPreguntas.alergiaSustancia),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.alergiaSustancia),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.alergiaAnestesia),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.alergiaAnestesia),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.bajoTratamiento),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.bajoTratamiento),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.intervenidoQx),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.intervenidoQx),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.enfGraveNoMencionada),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.enfGraveNoMencionada),r(2),s("ngIf",t.esPacienteMujer),r(6),s("value",!0),m("ngModel",t.otrasPreguntas.consumeAlcohol),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.consumeAlcohol),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.fuma),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.fuma),r(7),s("value",!0),m("ngModel",t.otrasPreguntas.consumeDrogas),r(3),s("value",!1),m("ngModel",t.otrasPreguntas.consumeDrogas),r(3),s("disabled",t.guardandoAntecedentes),r(),M(" ",t.guardandoAntecedentes?"Guardando...":"Guardar Cambios"," ")}}function ne(g,l){if(g&1){let t=b();i(0,"div",24)(1,"h2",25),a(2,"ANTECEDENTES ODONTOL\xD3GICOS"),n(),i(3,"div",62)(4,"div",63)(5,"label"),a(6,"Fecha de su \xFAltima visita dental:"),n(),i(7,"input",64),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Ultima_Visita,e)||(o.antecedentesOdonto.Ultima_Visita=e),_(e)}),n()(),i(8,"div",63)(9,"label"),a(10,"\xBFCu\xE1l fue el motivo de su consulta?"),n(),i(11,"textarea",65),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Motivo_Consulta,e)||(o.antecedentesOdonto.Motivo_Consulta=e),_(e)}),n()(),i(12,"div",63)(13,"label"),a(14,"\xBFC\xF3mo fue su experiencia?"),n(),i(15,"textarea",65),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Experiencia,e)||(o.antecedentesOdonto.Experiencia=e),_(e)}),n()(),i(16,"div",66)(17,"div",67)(18,"label"),a(19,"\xBFMolestias o dolor en la boca?"),n(),i(20,"div",68)(21,"label")(22,"input",69),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Molestias_Boca,e)||(o.antecedentesOdonto.Molestias_Boca=e),_(e)}),n(),a(23," S\xCD "),n(),i(24,"label")(25,"input",69),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Molestias_Boca,e)||(o.antecedentesOdonto.Molestias_Boca=e),_(e)}),n(),a(26," NO "),n()()(),i(27,"div",67)(28,"label"),a(29,"\xBFLe sangran las enc\xEDas?"),n(),i(30,"div",68)(31,"label")(32,"input",70),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Sangrado_Encias,e)||(o.antecedentesOdonto.Sangrado_Encias=e),_(e)}),n(),a(33," S\xCD "),n(),i(34,"label")(35,"input",70),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Sangrado_Encias,e)||(o.antecedentesOdonto.Sangrado_Encias=e),_(e)}),n(),a(36," NO "),n()()(),i(37,"div",67)(38,"label"),a(39,"\xBFSiente movilidad en sus dientes?"),n(),i(40,"div",68)(41,"label")(42,"input",71),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Movilidad_Dental,e)||(o.antecedentesOdonto.Movilidad_Dental=e),_(e)}),n(),a(43," S\xCD "),n(),i(44,"label")(45,"input",71),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Movilidad_Dental,e)||(o.antecedentesOdonto.Movilidad_Dental=e),_(e)}),n(),a(46," NO "),n()()(),i(47,"div",67)(48,"label"),a(49,"\xBFRechina sus dientes?"),n(),i(50,"div",68)(51,"label")(52,"input",72),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Rechina_Dientes,e)||(o.antecedentesOdonto.Rechina_Dientes=e),_(e)}),n(),a(53," S\xCD "),n(),i(54,"label")(55,"input",72),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Rechina_Dientes,e)||(o.antecedentesOdonto.Rechina_Dientes=e),_(e)}),n(),a(56," NO "),n()()(),i(57,"div",67)(58,"label"),a(59,"\xBFCu\xE1ntas veces al d\xEDa cepilla sus dientes?"),n(),i(60,"input",73),v("ngModelChange",function(e){u(t);let o=c(2);return p(o.antecedentesOdonto.Cepillado_Dia,e)||(o.antecedentesOdonto.Cepillado_Dia=e),_(e)}),n()()(),i(61,"div",50)(62,"button",51),C("click",function(){u(t);let e=c(2);return _(e.guardarAntecedentesOdonto())}),a(63),n()()()()}if(g&2){let t=c(2);r(7),m("ngModel",t.antecedentesOdonto.Ultima_Visita),r(4),m("ngModel",t.antecedentesOdonto.Motivo_Consulta),r(4),m("ngModel",t.antecedentesOdonto.Experiencia),r(7),s("value",1),m("ngModel",t.antecedentesOdonto.Molestias_Boca),r(3),s("value",0),m("ngModel",t.antecedentesOdonto.Molestias_Boca),r(7),s("value",1),m("ngModel",t.antecedentesOdonto.Sangrado_Encias),r(3),s("value",0),m("ngModel",t.antecedentesOdonto.Sangrado_Encias),r(7),s("value",1),m("ngModel",t.antecedentesOdonto.Movilidad_Dental),r(3),s("value",0),m("ngModel",t.antecedentesOdonto.Movilidad_Dental),r(7),s("value",1),m("ngModel",t.antecedentesOdonto.Rechina_Dientes),r(3),s("value",0),m("ngModel",t.antecedentesOdonto.Rechina_Dientes),r(5),m("ngModel",t.antecedentesOdonto.Cepillado_Dia),r(2),s("disabled",t.guardandoOdonto),r(),M(" ",t.guardandoOdonto?"Guardando...":"Guardar Cambios"," ")}}function ie(g,l){if(g&1){let t=b();i(0,"button",78),C("click",function(){u(t);let e=c(3);return _(e.mostrarFormEvolucion=!e.mostrarFormEvolucion)}),a(1," + Agregar Nueva Evoluci\xF3n "),n()}}function oe(g,l){if(g&1){let t=b();i(0,"div",79)(1,"h3"),a(2,"Nueva Evoluci\xF3n"),n(),i(3,"div",63)(4,"label"),a(5,"Fecha:"),n(),i(6,"input",64),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.nuevaEvolucion.Fecha,e)||(o.nuevaEvolucion.Fecha=e),_(e)}),n()(),i(7,"div",63)(8,"label"),a(9,"O.D. (\xD3rgano Dental):"),n(),i(10,"input",80),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.nuevaEvolucion.OD,e)||(o.nuevaEvolucion.OD=e),_(e)}),n()(),i(11,"div",63)(12,"label"),a(13,"Tratamiento:"),n(),i(14,"textarea",81),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.nuevaEvolucion.Tratamiento,e)||(o.nuevaEvolucion.Tratamiento=e),_(e)}),n()(),i(15,"div",63)(16,"label"),a(17,"Costo:"),n(),i(18,"input",82),v("ngModelChange",function(e){u(t);let o=c(3);return p(o.nuevaEvolucion.Costo,e)||(o.nuevaEvolucion.Costo=e),_(e)}),n()(),i(19,"div",50)(20,"button",51),C("click",function(){u(t);let e=c(3);return _(e.agregarEvolucion())}),a(21),n(),i(22,"button",83),C("click",function(){u(t);let e=c(3);return _(e.mostrarFormEvolucion=!1)}),a(23," Cancelar "),n()()()}if(g&2){let t=c(3);r(6),m("ngModel",t.nuevaEvolucion.Fecha),r(4),m("ngModel",t.nuevaEvolucion.OD),r(4),m("ngModel",t.nuevaEvolucion.Tratamiento),r(4),m("ngModel",t.nuevaEvolucion.Costo),r(2),s("disabled",t.guardandoEvolucion),r(),M(" ",t.guardandoEvolucion?"Guardando...":"Guardar Evoluci\xF3n"," ")}}function ae(g,l){if(g&1&&(i(0,"tr")(1,"td"),a(2),n(),i(3,"td"),a(4),n(),i(5,"td"),a(6),n(),i(7,"td"),a(8),T(9,"number"),n()()),g&2){let t=l.$implicit;r(2),x(t.Fecha),r(2),x(t.OD),r(2),x(t.Tratamiento),r(2),M("$",V(9,4,t.Costo,"1.2-2"))}}function re(g,l){if(g&1&&(i(0,"div",84)(1,"table")(2,"thead")(3,"tr")(4,"th"),a(5,"FECHA"),n(),i(6,"th"),a(7,"O.D."),n(),i(8,"th"),a(9,"TRATAMIENTO"),n(),i(10,"th"),a(11,"COSTO"),n()()(),i(12,"tbody"),f(13,ae,10,7,"tr",85),n()()()),g&2){let t=c(3);r(13),s("ngForOf",t.evoluciones)}}function le(g,l){g&1&&(i(0,"div",86)(1,"p"),a(2,"No hay evoluciones registradas a\xFAn."),n()())}function de(g,l){if(g&1&&(i(0,"div",24)(1,"h2",25),a(2,"NOTA DE EVOLUCI\xD3N"),n(),f(3,ie,2,0,"button",74)(4,oe,24,6,"div",75)(5,re,14,1,"div",76)(6,le,3,0,"div",77),n()),g&2){let t=c(2);r(3),s("ngIf",!t.mostrarFormEvolucion),r(),s("ngIf",t.mostrarFormEvolucion),r(),s("ngIf",t.evoluciones.length>0),r(),s("ngIf",t.evoluciones.length===0&&!t.mostrarFormEvolucion)}}function ce(g,l){if(g&1){let t=b();i(0,"div",14)(1,"div",15)(2,"button",16),C("click",function(){u(t);let e=c();return _(e.cambiarSeccion("datos"))}),a(3," \u{1F4CB} Datos del Paciente "),n(),i(4,"button",16),C("click",function(){u(t);let e=c();return _(e.cambiarSeccion("antecedentes"))}),a(5," \u{1FA7A} Antecedentes Personales "),n(),i(6,"button",16),C("click",function(){u(t);let e=c();return _(e.cambiarSeccion("odonto"))}),a(7," \u{1F9B7} Antecedentes Odontol\xF3gicos "),n(),i(8,"button",16),C("click",function(){u(t);let e=c();return _(e.cambiarSeccion("evolucion"))}),a(9," \u{1F4DD} Nota de Evoluci\xF3n "),n()(),i(10,"div",17)(11,"div",18)(12,"h1"),a(13,"HISTORIA CL\xCDNICA"),n(),i(14,"p",19),a(15),n()(),f(16,K,56,12,"div",20),i(17,"div",21)(18,"div",22),f(19,te,91,37,"div",23),n()(),f(20,ne,64,22,"div",20)(21,de,7,4,"div",20),n()()}if(g&2){let t=c();r(2),h("active",t.seccionActiva==="datos"),r(2),h("active",t.seccionActiva==="antecedentes"),r(2),h("active",t.seccionActiva==="odonto"),r(2),h("active",t.seccionActiva==="evolucion"),r(7),P("Dr(a). ",t.medicoNombre," ",t.medicoApellidos),r(),s("ngIf",t.seccionActiva==="datos"),r(3),s("ngIf",t.seccionActiva==="antecedentes"),r(),s("ngIf",t.seccionActiva==="odonto"),r(),s("ngIf",t.seccionActiva==="evolucion")}}var q=class g{route=y(k);api=y(Q);router=y(H);ANTECEDENTE_MAP={alergiaSustancia:17,alergiaAnestesia:18,bajoTratamiento:19,intervenidoQx:20,enfGraveNoMencionada:21,embarazada:22,consumeAlcohol:23,fuma:24,consumeDrogas:25};notificacion={mensaje:"",tipo:null};medicoNombre="";medicoApellidos="";medicoCorreo="";paciente=null;pacienteId=0;cargando=!0;error="";seccionActiva="datos";tiposAntecedente=[];antecedentesSeleccionados={};guardandoAntecedentes=!1;otrasPreguntas={alergiaSustancia:!1,alergiaAnestesia:!1,bajoTratamiento:!1,intervenidoQx:!1,enfGraveNoMencionada:!1,embarazada:!1,consumeAlcohol:!1,fuma:!1,consumeDrogas:!1};esPacienteMujer=!1;antecedentesOdonto={ID_Paciente:0,Ultima_Visita:"",Motivo_Consulta:"",Experiencia:"",Molestias_Boca:0,Sangrado_Encias:0,Movilidad_Dental:0,Rechina_Dientes:0,Cepillado_Dia:0};guardandoOdonto=!1;evoluciones=[];nuevaEvolucion={Fecha:(()=>{let l=new Date,t=l.getFullYear(),d=String(l.getMonth()+1).padStart(2,"0"),e=String(l.getDate()).padStart(2,"0");return`${t}-${d}-${e}`})(),OD:"",Tratamiento:"",Costo:0};mostrarFormEvolucion=!1;guardandoEvolucion=!1;ngOnInit(){this.cargarDatosMedico(),this.cargarHistorialPaciente()}cargarDatosMedico(){this.api.getRole().subscribe({next:l=>{l&&l.role==="Medico"&&(this.medicoNombre=l.nombre||"",this.medicoApellidos=l.apellidos||"",this.medicoCorreo=l.correo||"")},error:l=>{console.error("Error al cargar datos del m\xE9dico:",l)}})}cargarHistorialPaciente(){let l=this.route.snapshot.paramMap.get("idPaciente");if(this.pacienteId=l?Number(l):0,this.pacienteId<=0){this.error="ID de paciente inv\xE1lido",this.cargando=!1;return}this.obtenerHistorial()}obtenerHistorial(){this.cargando=!0,this.error="",this.api.getPacienteDetalle(this.pacienteId).subscribe({next:l=>{this.paciente=l,this.esPacienteMujer=l?.Sexo==="F",this.cargarDatosAntecedentes(),this.cargarAntecedentesOdonto(),this.cargarEvoluciones()},error:l=>{console.error("Error al cargar historial:",l),l.status===403?(this.error="Acceso denegado: Este paciente no est\xE1 asignado a usted.",setTimeout(()=>this.router.navigate(["/dashboard-medico"]),3e3)):l.status===404?this.error="Paciente no encontrado.":this.error="No se pudo cargar el historial cl\xEDnico del paciente.",this.cargando=!1}})}cargarDatosAntecedentes(){O({tipos:this.api.getTiposAntecedente(),guardados:this.api.getAntecedentesMedicos(this.pacienteId)}).subscribe({next:l=>{this.tiposAntecedente=l.tipos.filter(t=>t.ID_Tipo<=16),this.procesarAntecedentesGuardados(l.guardados),this.cargando=!1},error:l=>{console.error("Error al cargar tipos/valores de antecedentes:",l),this.cargando=!1}})}procesarAntecedentesGuardados(l){let t=Object.keys(this.ANTECEDENTE_MAP).reduce((d,e)=>(d[this.ANTECEDENTE_MAP[e]]=e,d),{});l.forEach(d=>{let e=t[d.ID_Tipo];e?Object.prototype.hasOwnProperty.call(this.otrasPreguntas,e)&&(this.otrasPreguntas[e]=!!d.Valor):this.antecedentesSeleccionados[d.ID_Tipo]=!!d.Valor})}guardarAntecedentesPersonales(){this.guardandoAntecedentes=!0,this.notificacion={mensaje:"",tipo:null};let l=this.tiposAntecedente.map(e=>({ID_Tipo:e.ID_Tipo,Valor:this.antecedentesSeleccionados[e.ID_Tipo]?1:0})),t=Object.keys(this.otrasPreguntas).filter(e=>!(e==="embarazada"&&!this.esPacienteMujer)).map(e=>({ID_Tipo:this.ANTECEDENTE_MAP[e],Valor:this.otrasPreguntas[e]?1:0})),d=[...l,...t];this.api.updateAntecedentesMedicos(this.pacienteId,d).subscribe({next:e=>{e.ok?(this.notificacion={mensaje:"Antecedentes personales guardados exitosamente.",tipo:"success"},alert("\xA1Antecedentes personales guardados correctamente!")):(this.notificacion={mensaje:"Error al guardar antecedentes personales (Respuesta no OK).",tipo:"error"},alert("Ocurri\xF3 un error al guardar los antecedentes.")),this.guardandoAntecedentes=!1},error:e=>{console.error("Error al guardar antecedentes:",e),this.notificacion={mensaje:"Error al guardar antecedentes personales. Verifique la consola.",tipo:"error"},alert("Ocurri\xF3 un error al guardar los antecedentes. Verifique la consola."),this.guardandoAntecedentes=!1}})}cargarAntecedentesOdonto(){this.api.getAntecedentesOdonto(this.pacienteId).subscribe({next:l=>{l?(l.Ultima_Visita&&typeof l.Ultima_Visita=="string"&&l.Ultima_Visita.includes("T")&&(l.Ultima_Visita=l.Ultima_Visita.split("T")[0]),this.antecedentesOdonto=l):this.antecedentesOdonto.ID_Paciente=this.pacienteId},error:l=>{console.error("Error al cargar antecedentes odontol\xF3gicos:",l)}})}guardarAntecedentesOdonto(){this.guardandoOdonto=!0,this.api.updateAntecedentesOdonto(this.pacienteId,this.antecedentesOdonto).subscribe({next:()=>{alert("Antecedentes odontol\xF3gicos guardados exitosamente"),this.guardandoOdonto=!1},error:l=>{console.error("Error al guardar antecedentes odontol\xF3gicos:",l),alert("Error al guardar antecedentes odontol\xF3gicos"),this.guardandoOdonto=!1}})}cargarEvoluciones(){this.api.getEvolucion(this.pacienteId).subscribe({next:l=>{this.evoluciones=l},error:l=>{console.error("Error al cargar evoluciones:",l)}})}agregarEvolucion(){if(!this.nuevaEvolucion.OD||!this.nuevaEvolucion.Tratamiento){alert("Por favor complete los campos requeridos");return}this.guardandoEvolucion=!0,this.api.addEvolucion(this.pacienteId,this.nuevaEvolucion).subscribe({next:()=>{alert("Evoluci\xF3n agregada exitosamente"),this.cargarEvoluciones(),this.mostrarFormEvolucion=!1,this.nuevaEvolucion={Fecha:new Date().toISOString().split("T")[0],OD:"",Tratamiento:"",Costo:0},this.guardandoEvolucion=!1},error:l=>{console.error("Error al agregar evoluci\xF3n:",l),alert("Error al agregar evoluci\xF3n"),this.guardandoEvolucion=!1}})}volverAlDashboard(){this.router.navigate(["/dashboard-medico"])}cambiarSeccion(l){this.seccionActiva=l}calcularEdad(l){let t=new Date,d=new Date(l),e=t.getFullYear()-d.getFullYear(),o=t.getMonth()-d.getMonth();return(o<0||o===0&&t.getDate()<d.getDate())&&e--,e}static \u0275fac=function(t){return new(t||g)};static \u0275cmp=S({type:g,selectors:[["app-historial-clinico"]],decls:14,vars:5,consts:[[1,"navbar-medico"],[1,"navbar-container"],[1,"navbar-brand"],[1,"navbar-info"],[1,"medico-nombre"],[1,"btn-volver",3,"click"],[1,"historial-wrapper"],["class","loading-container",4,"ngIf"],["class","error-container",4,"ngIf"],["class","historial-content",4,"ngIf"],[1,"loading-container"],[1,"spinner"],[1,"error-container"],[1,"error-icon"],[1,"historial-content"],[1,"tabs-navigation"],[1,"tab-btn",3,"click"],[1,"documento-clinico"],[1,"documento-header"],[1,"clinica-nombre"],["class","seccion-documento",4,"ngIf"],[1,"historial-container"],[1,"documento-content"],["class","seccion-documento antecedentes-personales",4,"ngIf"],[1,"seccion-documento"],[1,"seccion-titulo"],[1,"datos-grid-pdf"],[1,"dato-row"],[1,"dato-field","full-width"],[1,"dato-field"],[1,"checkbox-group"],[1,"checkbox"],[1,"dato-field","small"],[1,"seccion-documento","antecedentes-personales"],["class","antecedentes-checklist",4,"ngIf"],["class","mensaje-alerta",4,"ngIf"],[1,"divisor-antecedentes"],[1,"antecedentes-preguntas-sino"],[1,"pregunta-row"],[1,"pregunta-texto"],[1,"opciones-sino"],["type","radio","name","alergiaSustancia",3,"ngModelChange","value","ngModel"],["type","radio","name","alergiaAnestesia",3,"ngModelChange","value","ngModel"],["type","radio","name","bajoTratamiento",3,"ngModelChange","value","ngModel"],["type","radio","name","intervenidoQx",3,"ngModelChange","value","ngModel"],["type","radio","name","enfGrave",3,"ngModelChange","value","ngModel"],["class","pregunta-row",4,"ngIf"],["type","radio","name","alcohol",3,"ngModelChange","value","ngModel"],["type","radio","name","fuma",3,"ngModelChange","value","ngModel"],["type","radio","name","drogas",3,"ngModelChange","value","ngModel"],[1,"form-actions"],[1,"btn-guardar",3,"click","disabled"],[1,"antecedentes-checklist"],[1,"antecedentes-grid-columnas"],["class","antecedente-item",4,"ngFor","ngForOf"],[1,"antecedente-item"],[1,"checkbox-container"],["type","checkbox",3,"ngModelChange","id","ngModel"],[3,"for"],[1,"linea-detalle"],[1,"mensaje-alerta"],["type","radio","name","embarazada",3,"ngModelChange","value","ngModel"],[1,"form-odonto"],[1,"form-group"],["type","date",1,"input-field",3,"ngModelChange","ngModel"],["rows","2",1,"textarea-field",3,"ngModelChange","ngModel"],[1,"preguntas-sino"],[1,"pregunta-item"],[1,"radio-group"],["type","radio","name","molestias",3,"ngModelChange","value","ngModel"],["type","radio","name","sangrado",3,"ngModelChange","value","ngModel"],["type","radio","name","movilidad",3,"ngModelChange","value","ngModel"],["type","radio","name","rechina",3,"ngModelChange","value","ngModel"],["type","number","min","0","max","10",1,"input-small",3,"ngModelChange","ngModel"],["class","btn-agregar-evolucion",3,"click",4,"ngIf"],["class","form-evolucion",4,"ngIf"],["class","tabla-evolucion",4,"ngIf"],["class","sin-datos",4,"ngIf"],[1,"btn-agregar-evolucion",3,"click"],[1,"form-evolucion"],["type","text","placeholder","Ej: 11, 12, 13...",1,"input-field",3,"ngModelChange","ngModel"],["rows","4","placeholder","Describa el tratamiento realizado...",1,"textarea-field",3,"ngModelChange","ngModel"],["type","number","placeholder","0.00","step","0.01",1,"input-field",3,"ngModelChange","ngModel"],[1,"btn-cancelar",3,"click"],[1,"tabla-evolucion"],[4,"ngFor","ngForOf"],[1,"sin-datos"]],template:function(t,d){t&1&&(i(0,"nav",0)(1,"div",1)(2,"div",2)(3,"h2"),a(4,"\u{1F3E5} Historia Cl\xEDnica"),n()(),i(5,"div",3)(6,"span",4),a(7),n(),i(8,"button",5),C("click",function(){return d.volverAlDashboard()}),a(9," \u2190 Volver al Dashboard "),n()()()(),i(10,"div",6),f(11,Y,4,0,"div",7)(12,J,5,1,"div",8)(13,ce,22,14,"div",9),n()),t&2&&(r(7),P("Dr(a). ",d.medicoNombre," ",d.medicoApellidos),r(4),s("ngIf",d.cargando),r(),s("ngIf",d.error&&!d.cargando),r(),s("ngIf",!d.cargando&&!d.error&&d.paciente))},dependencies:[I,D,A,U,N,j,F,z,B,R,G,L,W],styles:[".navbar-medico[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:1rem 2rem;box-shadow:0 2px 10px #0000001a;position:sticky;top:0;z-index:100}.navbar-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}.navbar-brand[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.navbar-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.btn-volver[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);padding:.5rem 1.25rem;border-radius:8px;cursor:pointer;transition:all .3s ease}.btn-volver[_ngcontent-%COMP%]:hover{background:#ffffff4d}.historial-wrapper[_ngcontent-%COMP%]{background:#f5f7fa;min-height:calc(100vh - 70px);padding:2rem}.loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem}.spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 1rem}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.tabs-navigation[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto 2rem;display:flex;gap:.5rem;background:#fff;border-radius:12px;padding:.5rem;box-shadow:0 2px 8px #0000001a}.tab-btn[_ngcontent-%COMP%]{flex:1;padding:.75rem 1rem;border:none;background:transparent;color:#666;cursor:pointer;border-radius:8px;font-weight:500;transition:all .3s ease}.tab-btn[_ngcontent-%COMP%]:hover{background:#f5f7fa}.tab-btn.active[_ngcontent-%COMP%]{background:#667eea;color:#fff}.historial-content[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto}.documento-clinico[_ngcontent-%COMP%]{background:#fff;padding:3rem;border-radius:12px;box-shadow:0 4px 20px #0000001a;min-height:800px}.documento-header[_ngcontent-%COMP%]{text-align:center;border-bottom:3px solid #333;padding-bottom:1rem;margin-bottom:2rem}.documento-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;color:#333;letter-spacing:2px}.clinica-nombre[_ngcontent-%COMP%]{margin:.5rem 0 0;color:#666;font-size:1rem}.seccion-documento[_ngcontent-%COMP%]{margin-bottom:2rem}.seccion-titulo[_ngcontent-%COMP%]{background:#333;color:#fff;padding:.75rem 1rem;margin:0 0 1.5rem;font-size:1.1rem;letter-spacing:1px}.datos-grid-pdf[_ngcontent-%COMP%]{border:2px solid #333;padding:1.5rem}.dato-row[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem;border-bottom:1px solid #ddd;padding-bottom:.75rem}.dato-row[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}.dato-field[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:.5rem}.dato-field.full-width[_ngcontent-%COMP%]{flex:1 1 100%}.dato-field.small[_ngcontent-%COMP%]{flex:0 0 120px}.dato-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;white-space:nowrap}.dato-field[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#555;border-bottom:1px solid #999;flex:1;padding:.25rem 0}.checkbox-group[_ngcontent-%COMP%]{display:flex;gap:1rem;border-bottom:none!important}.checkbox[_ngcontent-%COMP%]{display:inline-block;width:20px;height:20px;border:2px solid #333;text-align:center;line-height:18px;font-weight:700;cursor:pointer}.checkbox.checked[_ngcontent-%COMP%]{background:#333;color:#fff}.antecedentes-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:2rem;border:2px solid #333;padding:1.5rem}.antecedente-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.antecedente-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.antecedente-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333;cursor:pointer}.form-odonto[_ngcontent-%COMP%], .form-evolucion[_ngcontent-%COMP%]{border:2px solid #333;padding:1.5rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:600;color:#333;margin-bottom:.5rem}.input-field[_ngcontent-%COMP%], .textarea-field[_ngcontent-%COMP%], .input-small[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #999;border-radius:4px;font-size:1rem;font-family:inherit}.input-small[_ngcontent-%COMP%]{width:100px}.textarea-field[_ngcontent-%COMP%]{resize:vertical}.preguntas-sino[_ngcontent-%COMP%]{border-top:1px solid #ddd;padding-top:1rem;margin-top:1rem}.pregunta-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #eee}.pregunta-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#333}.radio-group[_ngcontent-%COMP%]{display:flex;gap:2rem}.radio-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;cursor:pointer;font-weight:600}.radio-group[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:18px;height:18px;cursor:pointer}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem;justify-content:center}.btn-guardar[_ngcontent-%COMP%], .btn-cancelar[_ngcontent-%COMP%], .btn-agregar-evolucion[_ngcontent-%COMP%]{padding:.75rem 2rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s ease}.btn-guardar[_ngcontent-%COMP%]{background:#4caf50;color:#fff}.btn-guardar[_ngcontent-%COMP%]:hover:not(:disabled){background:#45a049}.btn-guardar[_ngcontent-%COMP%]:disabled{background:#ccc;cursor:not-allowed}.btn-cancelar[_ngcontent-%COMP%]{background:#f44336;color:#fff}.btn-cancelar[_ngcontent-%COMP%]:hover{background:#da190b}.btn-agregar-evolucion[_ngcontent-%COMP%]{background:#667eea;color:#fff;margin-bottom:1.5rem}.btn-agregar-evolucion[_ngcontent-%COMP%]:hover{background:#5568d3}.tabla-evolucion[_ngcontent-%COMP%]{border:2px solid #333;margin-top:2rem;overflow-x:auto}.tabla-evolucion[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.tabla-evolucion[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#333;color:#fff;padding:.75rem;text-align:left;font-weight:600}.tabla-evolucion[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;border-bottom:1px solid #ddd;color:#555}.tabla-evolucion[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f5f7fa}.sin-datos[_ngcontent-%COMP%]{text-align:center;padding:3rem;color:#999;border:2px dashed #ddd}.documento-footer[_ngcontent-%COMP%]{margin-top:4rem;padding-top:2rem;border-top:2px solid #333}.firma-section[_ngcontent-%COMP%]{display:flex;justify-content:space-around;gap:2rem}.firma-box[_ngcontent-%COMP%]{flex:1;text-align:center}.firma-linea[_ngcontent-%COMP%]{height:60px;border-bottom:2px solid #333;margin-bottom:.5rem}.firma-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0;font-weight:600;color:#333}.doctor-nombre[_ngcontent-%COMP%]{font-size:.9rem;color:#666}@media (max-width: 768px){.documento-clinico[_ngcontent-%COMP%]{padding:1.5rem}.tabs-navigation[_ngcontent-%COMP%]{flex-direction:column}.antecedentes-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.dato-row[_ngcontent-%COMP%], .firma-section[_ngcontent-%COMP%]{flex-direction:column}}@media print{.navbar-medico[_ngcontent-%COMP%], .tabs-navigation[_ngcontent-%COMP%], .form-actions[_ngcontent-%COMP%], .btn-agregar-evolucion[_ngcontent-%COMP%]{display:none!important}.documento-clinico[_ngcontent-%COMP%]{box-shadow:none;padding:1rem}body[_ngcontent-%COMP%]{background:#fff}}.seccion-documento[_ngcontent-%COMP%]{padding:20px;background-color:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 4px #0000000d}.seccion-titulo[_ngcontent-%COMP%]{font-size:1.5rem;color:#333;border-bottom:2px solid #0056b3;padding-bottom:10px;margin-bottom:20px;text-align:center}.antecedentes-checklist[_ngcontent-%COMP%]{margin-bottom:30px}.antecedentes-grid-columnas[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px 50px}.antecedente-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;font-size:1rem}.checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center;flex-shrink:0}.checkbox-container[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:10px;transform:scale(1.2);cursor:pointer}.linea-detalle[_ngcontent-%COMP%]{flex-grow:1;border-bottom:1px solid #ccc;margin-left:10px}.divisor-antecedentes[_ngcontent-%COMP%]{border:0;height:1px;background-color:#ccc;margin:20px 0}.antecedentes-preguntas-sino[_ngcontent-%COMP%]{border:1px solid #eee;border-radius:4px}.pregunta-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 15px;border-bottom:1px solid #f5f5f5;background-color:#fafafa}.pregunta-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.pregunta-texto[_ngcontent-%COMP%]{margin:0;font-weight:500;color:#444}.opciones-sino[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-left:25px;font-size:.95rem;cursor:pointer}.opciones-sino[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:5px;transform:scale(1.1)}.form-actions[_ngcontent-%COMP%]{text-align:center;margin-top:30px}.btn-guardar[_ngcontent-%COMP%]{padding:10px 25px;font-size:1.1rem;font-weight:700;color:#fff;background-color:#28a745;border:none;border-radius:6px;cursor:pointer;transition:background-color .3s,opacity .3s}.btn-guardar[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#218838}.btn-guardar[disabled][_ngcontent-%COMP%]{background-color:#90d89e;cursor:not-allowed}.mensaje-alerta[_ngcontent-%COMP%]{padding:15px;border:1px solid #ffcc00;background-color:#fffacd;color:#856404;border-radius:4px;text-align:center}"]})};export{q as HistorialClinico};
